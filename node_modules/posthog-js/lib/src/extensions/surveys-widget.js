import { document as _document } from '../utils/globals';
import { addSurveyCSSVariablesToElement, getSurveyContainerClass } from './surveys/surveys-extension-utils';
import { prepareStylesheet } from './utils/stylesheet-loader';
import widgetStyles from './surveys/widget.css';
// We cast the types here which is dangerous but protected by the top level generateSurveys call
var document = _document;
export function retrieveWidgetShadow(survey, posthog) {
    var widgetClassName = getSurveyContainerClass(survey);
    var existingDiv = document.querySelector(".".concat(widgetClassName));
    if (existingDiv && existingDiv.shadowRoot) {
        return existingDiv.shadowRoot;
    }
    // If it doesn't exist, create it
    var div = document.createElement('div');
    addSurveyCSSVariablesToElement(div, survey.appearance);
    div.className = widgetClassName;
    var shadow = div.attachShadow({ mode: 'open' });
    var stylesheet = createWidgetStylesheet(posthog);
    if (stylesheet) {
        shadow.appendChild(stylesheet);
    }
    document.body.appendChild(div);
    return shadow;
}
export function createWidgetStylesheet(posthog) {
    return prepareStylesheet(document, typeof widgetStyles === 'string' ? widgetStyles : '', posthog);
}
//# sourceMappingURL=surveys-widget.js.map